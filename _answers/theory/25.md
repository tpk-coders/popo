Создание иерархии объектов и уровней ссылок
---

### Иерархия объектов

Объект Application (то есть Excel ) содержит другие объекты. Ниже приведено не­сколько примеров объектов, которые находятся в объекте Application :

Workbooks (коллекция всех объектов Workbook —рабочих книг);

Windows (коллекция всех объектов Window — окон);

Addlns (коллекция всех объектов Addln — надстроек).

Некоторые объекты могут содержать другие объекты. Например, коллекция Workbooks состоит из всех открытых объектов Workbook , а объект Workbook включает другие объек­ты, некоторые из которых представлены ниже:

Worksheets (коллекция объектов Worksheet — рабочих листов);

Charts (коллекция объектов Chart —диаграмм);

Names (коллекция объектов Name — имен).

Каждый из этих объектов, в свою очередь, может содержать другие объекты. Коллекция Worksheets состоит из всех объектов Worksheet рабочей книги Workbook . Объект Worksheet включает другие объекты, среди которых следующие:

ChartObjects (коллекция объектов. ChartQb ject — элементов диаграмм);

Range — диапазон;

PageSetup — параметры страницы;

PivotTables (коллекция объектов PivotTable — сводных таблиц).

Может быть, вы пока не готовы правильно воспринять подобную концепцию, но со временем наверняка поймете, что иерархия объектов вполне логична и хорошо структури­рована. Кстати, вся объектная модель Excel схематически изображена в электронной спра­вочной системе.

### Ссылки на объекты

Если вы ссылаетесь на объект в VBA , для обращения к нему вводятся названия всех рас­положенных выше в иерархической структуре объектов, разделенных точкой. Что делать, ес­ли в Excel открыты две рабочих книги, и в обеих имеется рабочий лист с названием Лист1? В этом случае в ссылке упоминается контейнер требуемого объекта: Workbooks ("Книга1"). Worksheets ("Лист1"}

Без указания рабочей книги редактор Visual Basic искал бы лист Лист1 в активной рабо­чей книге.

Чтобы сослаться на определенный диапазон (например, ячейку А1) на рабочем листе с на­званием Лист1 в рабочей книге Книга1, можно использовать следующее выражение:

Workbooks(" Книга 1").Worksheets(" Лист 1").Range("Al")

Полная ссылка из предыдущего примера включает объект Application и выглядит та­ким образом:

Application.Workbooks(" Книга 1").Worksheets(" Лист 1").Range(“Al”)

Однако в большинстве случаев можно опускать объект Application в ссылках (кроме него использоваться больше нечему). Если объект Книга1 — это активная рабочая книга, то опустите ссылку на нее и запишите рассматриваемое выражение следующим образом:

Worksheets ("Лист1"). Range (" Al ")

Если Лист1 является активным рабочим листом, можно еще более упростить выражение:

Range (" Al ")
